#Include C:\Users\%A_UserName%\Dropbox\Include\Windows\functions.ahk
global include := "C:\Users\" A_UserName "\Dropbox\Include\Windows"

#NoEnv
SetWorkingDir %A_ScriptDir%
CoordMode, Mouse, Window
SendMode Input
#SingleInstance Force
SetTitleMatchMode 2
DetectHiddenWindows On
#WinActivateForce
SetControlDelay 1
SetWinDelay 0
SetKeyDelay 50, 50
SetMouseDelay, 50
SetBatchLines -1
#Persistent  ; Prevent the script from exiting automatically.

goToFrame(frameNum)
{
	Text:="|<>*145$42.y000000U000000U000000USS/j3nUM2At4NyM38F48UET8FDsUEn8FA0UEX8F40UEX8F69UET8F3lU"
	WinActivate, iPi Mocap Studio
	cvClick(Text,, XOffset:=50)
	Sleep, 500
	Send, ^a
	Send, %frameNum%{Enter}
	SLeep, 500
}

individualBodyParts()
{	
	Text:="|<>*192$201.zzzzzzzzzzz02000000000000000000007zzzzzzzzzzs0E00000000000000000000zzzzzzzzzzz02000000000000000000007zzzzzzzzzzs0E00000000000000000000zzzzzzzzzzz02000000000000000000007zzzzzzzzzzs0E00000000000000000000zzzzzzzzzzz02000000000000000000007zzzzzzzzzzs0E00000000000000000000zzzzzzzzzzz02000000000000000000007zzzzzzzzzzs0E00000000000000000000zzzzzzzzzzz02000000000000000000007zzzzzzzzzzs0E00000000000000000000zzzzzzzzzzz02000000000000000000007zzzzzzzzzzs0E00000000000000000000zzzzzzzzzzz02000000000000000000007zzzzzzzzzzs0E00000000000000000000zzzzzzzzzzz02000000000000000000007zzzzzzzzzzs0E00000000000000000000zzzzzzzzzzz02000000000000000000007zzzzzzzzzzs0E00000000000000000000zzzzzzzzzzz02000000000000000000007zzzzzzzzzzs0E00000000000000000000zzzzzzzzzzz02000000000000000000007zzzzzzzzzzs0E00000000000000000000zzzzzzzzzzz02000000000000000000007zzzzzzzzzzs0E00000000000000000000zzzzzzzzzzz02000000000000000000007zzzzzzzzzzs0E00000000000000000000zzzzzzzzzzz02000000000000000000007zzzzzzzzzzs0E00000000000000000000zzzzzzzzzzz02000000000000000000007zzzzzzzzzzs0E00000000000000000000zzzzzzzzzzz02000000000000000000007zzzzzzzzzzs0E000k0000000000000000zzzzzzzzzzz02001zs0000000000000007zzzzzzzzzzs0E00w3k000000000000000zzzzzzzzzzz0200C070000000000000007zzzzzzzzzzs0E0300A000000000000000zzzzzzzzzzz0200k00k000000000000007zzzzzzzzzzs0E0A006000000000000000zzzzzzzzzzz0201U00M000000000000007zzzzzzzzzzs0E080010M00NU3UA0030z0zzzzzzzzzzz0203000A3003A0Q1U00M7w7zzzzzzzzzzs0E0MC71UM00M000A0030lUzzzzzzzzzzz02031tsA3DkzBXQzgMwM6ATzzzzzzzzzzs0E0M7y1UNzDtgPbxXBn0n7zzzzzzzzzzz02030TUA3ANXAnRXgM6M7srzzzzzzzzzzs0E0M1s1UNXQNangBX7n0zazzzzzzzzzzz0203060A3APXAqRVgNqM6Arzzzzzzzzzzs0E080010NXANXngRXQn0lazzzzzzzzzzz0201U00M3ANzAQRzjtyM7wzzzzzzzzzzzs0E040060NX7tXXbwzDn0z3zzzzzzzzzzz0200k00k000000000000007zzzzzzzzzzs0E0300A000000000000000zzzzzzzzzzz0200C070000000000000007zzzzzzzzzzs0E00w3k000000000000000zzzzzzzzzzz02001zs0000000000000007zzzzzzzzzzs0E000k0000000000000000zzzzzzzzzzz02000000000000000000007zzzzzzzzzzs0E00000000000000000000zzzzzzzzzzz02000000000000000000007zzzzzzzzzzs0E00000000000000000000zzzzzzzzzzz02000T00000000000000007zzzzzzzzzzs0E00Dz0000000000000000zzzzzzzzzzz020070C0000000000000007zzzzzzzzzzs0E01U0M000000000000000zzzzzzzzzzz0200M01U000000000000007zzzzzzzzzzs0E06006000000000000000zzzzzzzzzzz0201U00M000000000000007zzzzzzzzzzs0E0A0030703000000030DUzzzzzzzzzzz020100080w0M0000000M3z7zzzzzzzzzzs0E0M421U7U3000000030sMzzzzzzzzzzz02031ksA1g7v7SDkwS7s63jzzzzzzzzzzs0E0MDD1UBlzQqNzDrNz1kBzzzzzzzzzzz02030zkA1aQNa3APUlwMC1jzzzzzzzzzzs0E0M3w1UQn3BXtXMDz31kBzzzzzzzzzzz02030D0A3zMNgvAP1kMM63jzzzzzzzzzzs0E0M0k10TvX7aNXQ63X0sNzzzzzzzzzzz0201000M73DsszANyvDs3yDzzzzzzzzzzs0E0A0030kQz77tX7Xsz0DVzzzzzzzzzzz0200k00k00000000000000Dzzzzzzzzzzs0E0600A000000000000001zzzzzzzzzzz0200Q03U00000000000000Dzzzzzzzzzzs0E01k0k000000000000000zzzzzzzzzzz02003lw0000000000000007zzzzzzzzzzs0E007y0000000000000000zzzzzzzzzzz02000000000000000000007zzzzzzzzzzs0E00000000000000000000zzzzzzzzzzz02000000000000000000007zzzzzzzzzzs0E00000000000000000000zzzzzzzzzzz02000000000000000000004"
	WinActivate, iPi Mocap Studio
	cvClick(Text, 1)
}

trackingTab()
{
	Text:="|<>*182$74.zs1zzzDnzzzzzznzzznzzzzzzzwzzzwzzzzzzzzC67VAH0s7zzznbAnHAnAlzzzwtz9w7AvCTzzzCS2T3nC7bzzznbAbkwnVtzzzwtb9wbAtCTzzzCQXBAnCH7zzznb0sHYna1zzzzzzzzzzzyTzzzzzzzzzzzDzzzzzzzzzzw7zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzw000000000000U"
	cvClick(Text, 1)
}

cvClick(Text, delay:=-1, XOffset:=0, YOffset:=0)
{
	if (FindText(X:="wait", Y:=delay, 0, 0, 0, 0, 0, 0, Text))
	{
		X += XOffset
		Y += YOffset
		FindText().Click(X, Y, "L")
	}
}

cvClickWait(Text, delay:=1, XOffset:=0, YOffset:=0)
{
	while (FindText(X:="wait", Y:=delay, 0, 0, 0, 0, 0, 0, Text))
		continue
}

enableLeftArm()
{
	Text:="|<>*166$79.zzy0000000000E010000000000800U000000000400E200C00U002008100AE0s0010040U0680I000U020E7bz0/7rrE01086NW09XXAs00U424l04FV6A00E23yMU6AkX600811UAE3yMFX0040UE6811A8lU020EAH61Uq4Mk010DnlVUU/2AM00U0000000007zzk0000000002"
	cvClick(Text, delay:=1)
}

enableRightArm()
{
	Text:="|<>*164$89.zzy00000000000100400000000000200800000000000400E3sk0E006000800U4M00U40C000E0108E01080I000U020EaDmsw1cSzR0040XAlaMU2MlnC0081sN3AF04FX6A00E2Mm6EW0MX68M00U4FYAV40zaAEk0108n8N2811AMVU020EqNm4E63Ml30040VgTY8s86lW6008000200000007zzk000A00000000000007k0000000E"
	cvClick(Text, delay:=1)
}

enableLeftLeg()
{
	Text:="|<>*162$75.zzy000000000400E000000000U02000000000400E200C04000U020E0340U00400E200MU4000U020E7bz0UD3g00E21aMU42AXU020E8H40UkgA00E23yMU47xVU020EM340Uk8A00E210MU461VU020EAH60UM4Q00E3wwMM7tsRU02000000000Dzzk000000003000000000007Y"
	cvClick(Text, delay:=1)
}

enableRightLeg()
{
	Text:="|<>*160$85.zzy00000000000E0100000000000800U0000000000400E3sk0E00E002008160081080010040V0040U4000U020EaDmsw20wCk0108nANa810W8s00U7VYAl40UlgA00E2Mm6EW0ETo600814N38F08A230040XAVY8U461XU020EqNm4E210lk0108P7t2C1wSDM00U0008000000Tzzk000A0000008000001w000003t"
	cvClick(Text, delay:=1)
}

disableLeftArm()
{
	Text:="|<>*165$79.zzy0000000000E010000000000800U000000000402E200C00U00203c100AE0s00103o0U0680I000U1m0E7bz0/7rrE1l086NW09XXAslsU424l04FV6AwsE23yMU6AkX6Ds811UAE3yMFX1w40UE6811A8lUQ20EAH61Uq4Mk410DnlVUU/2AM00U0000000007zzk0000000002"
	cvClick(Text, delay:=1)
}

disableRightArm()
{
	Text:="|<>*163$89.zzy00000000000100400000000000200800000000000402E3sk0E00600080CU4M00U40C000E0t08E01080I000U3m0EaDmsw1cSzR0D40XAlaMU2MlnCMQ81sN3AF04FX6BtkE2Mm6EW0MX68NzUU4FYAV40zaAEky108n8N2811AMVUs20EqNm4E63Ml30U40VgTY8s86lW6008000200000007zzk000A00000000000007k0000000E"
	cvClick(Text, delay:=1)
}

disableLeftLeg()
{
	Text:="|<>*161$75.zzy000000000400E000000000U0G000000000407E200C04000U1u0E0340U0040CE200MU4000U3W0E7bz0UD3gMQE21aMU42AXbb20E8H40UkgAysE23yMU47xVXy20EM340Uk8A7UE210MU461VUQ20EAH60UM4Q10E3wwMM7tsRU02000000000Dzzk000000003000000000007Y"
	cvClick(Text, delay:=1)
}

disableRightLeg()
{
	Text:="|<>*160$85.zzy00000000000E0100000000000804U0000000000407E3sk0E00E0020781600810800107Y0V0040U4000U3W0EaDmsw20wCn3V08nANa810W8vnkU7VYAl40UlgBxkE2Mm6EW0ETo6Tk814N38F08A233s40XAVY8U461XUs20EqNm4E210lk8108P7t2C1wSDM00U0008000000Tzzk000A0000008000001w000003t"
	cvClick(Text, delay:=1)
}

enableAppendages()
{
	trackingTab()
	individualBodyParts()
	
	; Left Arm
	enableLeftArm()
	; Right Arm
	enableRightArm()
	; Left Leg
	enableLeftLeg()
	; Right Leg
	enableRightLeg()
}

disableAppendages()
{
	trackingTab()
	individualBodyParts()
	; Left Arm
	disableLeftArm()
	; Right Arm
	disableRightArm()
	; Left Leg
	disableLeftLeg()
	; Right Leg
	disableRightLeg()
}

disableFootTracking()
{
	Text:="|<>*161$155.zzy00000000000000000000001004000000000000000000000020080000000000000000000000402E3w0020k01k00000000k80080CU400041U02000810001U000E0x0800083004000E200030000U1m0E5kwL6D0yS3nsDDS3qNBkz0740UAm8lAn0FW8l08MW8gWQnCAS81wEUF3N20a6kW0EU4kO4lYAwsE20V7W6nw1ABVY0V1t0s9XMMzUU412N4BY02MO38124G1sH6kkT10825W8H804kq4E24Ma3MaAVUQ20E49ANaMU8l4MU68n4KNANb0E40z8HsyAS0Ew7Vk6Eu7gOMlq0080000000000000000000000A00E0000000000000000000000zzzU000000000000000000000TE"
	WinActivate, iPi Mocap Studio
	cvClick(Text, 1)
}

enableFootTracking()
{
	Text:="|<>*160$155.zzy00000000000000000000001004000000000000000000000020080000000000000000000000400E3w0020k01k00000000k800800U400041U02000810001U000E010800083004000E200030000U020E5kwL6D0yS3nsDDS3qNBkz0040UAm8lAn0FW8l08MW8gWQnC0081wEUF3N20a6kW0EU4kO4lYA00E20V7W6nw1ABVY0V1t0s9XMM00U412N4BY02MO38124G1sH6kk010825W8H804kq4E24Ma3MaAVU020E49ANaMU8l4MU68n4KNANb0040z8HsyAS0Ew7Vk6Eu7gOMlq0080000000000000000000000A00E0000000000000000000000zzzU000000000000000000000TE"
	WinActivate, iPi Mocap Studio
	cvClick(Text, 1)
}

disableGroundCollisions()
{
	Text:="|<>*161$184.zzy0000000000000000000000000002008000000000000000000000000000800U000000000000000000000000000U0W0T000k400000000020006H0A0002078100030E0000000008000N00000080sU4000A10000000000U001Y000000U3W0EDlsz4D0CbnlX/Uy0SD6HDAS5ky0Q810l0n6F416QFaAn4M236NAUn4NY9XkU7n41A9AMA9X2Mn4kUE89Ym38N2EjC20EAMwkYzUkaABX8G210UaHABUY9mTk810lgH2H022MUqAV88422NAAq2EVcT0U436VA9A0A9X2Mm4lUE89YkP8N21Us20EAPAl4E0Fa4MX8H61UlaHFgl48C1081wlbnwEw0uMD3wV7c3lwNAwlsEbc00U000000000800000000000000000U020000000001U00000000000000003zzs000000001s000000000000000008"
	WinActivate, iPi Mocap Studio
	cvClick(Text, 1)
}

enableHeadTracking()
{
	Text:="|<>*163$161.zzy00000000000000000000000100400000000000000000000000200800000000000000000000000400E3w0020k030000600000UM00800U400041U060000A300010000E01080008300A0000M600020000U020E5kwL6D0TVswDkTSS7YP/Uz0040UAm8lAn0l4FAlUMk6M9aNWC0081wEUF3N21XMk930lUAUKAlAA00E20V7W6nw36zXm61X3v0sN2EM00U412N4BY06BUMYA36Aq1km4Uk010825W8H80AP0V8M6AFY2lY9XU020E49ANaMUMm1aNkAMXA4n8H70040z8HsyAS0lXlwTUCkyD8qEXq00800000000000000000000000Tzzk00000000000000000000000U0000000000000000000000000yE"
	WinActivate, iPi Mocap Studio
	cvClick(Text, 1)
}

disableHeadTracking()
{
	Text:="|<>*161$161.zzy00000000000000000000000100400000000000000000000000201800000000000000000000000407E3w0020k030000600000UM0080SU400041U060000A300010000E0t080008300A0000M600020000U3W0E5kwL6D0TVswDkTSS7YP/Uz6740UAm8lAn0l4EAlUMk6M9aNWCSQ81wEUF3N21XMk930lUAUKAlAAysE20V7W6nw36zXm61X3v0sN2EMzUU412N4BY06BUMYA36Aq1km4UkS10825W8H80AP0V8M6AFY2lY9XUQ20E49ANaMUMm1aNkAMXA4n8H70E40z8HsyAS0lXlwTUCkyD8qEXq00800000000000000000000000Tzzk00000000000000000000000U0000000000000000000000000yE"
	WinActivate, iPi Mocap Studio
	cvClick(Text, 1)
}

enableGroundCollisions()
{
	Text:="|<>*161$184.zzy0000000000000000000000000002008000000000000000000000000000800U000000000000000000000000000U020T000k400000000020006H0A0002008100030E0000000008000N000000800U4000A10000000000U001Y000000U020EDlsz4D0CbnlX/Uy0SD6HDAS5ky00810l0n6F416QFaAn4M236NAUn4NY800U7n41A9AMA9X2Mn4kUE89Ym38N2EU020EAMwkYzUkaABX8G210UaHABUY9m00810lgH2H022MUqAV88422NAAq2EVc00U436VA9A0A9X2Mm4lUE89YkP8N21U020EAPAl4E0Fa4MX8H61UlaHFgl48C0081wlbnwEw0uMD3wV7c3lwNAwlsEbc00U000000000800000000000000000U020000000001U00000000000000003zzs000000001s000000000000000008"
	WinActivate, iPi Mocap Studio
	cvClick(Text, 1)
}

refitPose()
{
	WinActivate, iPi Mocap Studio
	Send, ^+r ; refit shortcut
	
	; Wait until Finished
	Text:="|<>*158$116.0007000000000000000Ds03600M000000000003300lW26000000000000kk0A0UU000000000000A403088000000000000333nxjjaPkTUBsDVwD00kV6AMUVb4Ms3X6AlAM0DkkX688NVY60kH1A3203A8AlW26MN1UA6UPUUU0lXzAMUVa6kM31c6CTs0AAU3688NVg60kG1Um0033A0lW26MN1UA4kE4U00kP2AMUVa6Ms3X6AXA9aQ6D36CCNVXq0zUyDVwNY0000000001UA00000000000000000M300000000000000004A0k0000000000000001y0A000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000Tzzzzzzzzzzzzzzzzy0400000000000000000U10000000000000000080E000000000000000020400000000000000000U10000000000000000080E000000000000000020400000000000000000U10000000000000000080E000000000000000020400000000000000000U10000000000000000080E00T00000A0rs010020400ME000030N000M00U100A000000k4E0020080E030D7sSDA341swk020400U2NmAYH0l0WNA00U100802Mq36k8T8A10080E0207aBUzg243X0E020400U69XEA30V0AU400U100A12Mq30kAE1g30080E01VNaAWFA342N4k020400DXtX7bn0FywD800U10000000000600060080E0000000000k0010020400000000000000000U10000000000000000080E000000000000000020400000000000000000U10000000000000000080E000000000000000020400000000000000000U10000000000000000080E0000000000000000207zzzzzzzzzzzzzzzzzUU"
	Sleep, 1000
	WinActivate, iPi Mocap Studio
	cvClickWait(Text)
}

trackBackward()
{
	WinActivate, iPi Mocap Studio
	Send, ^+`,
	waitUntilTrackingDone()
}

waitUntilTrackingDone()
{
	; Wait Until Finished
	Text:="|<>*115$45.zzzzzzzw0000001U000000A0000001U000000A0000001U000000A0000001U000000A0000001U000000A0S00001U410000A0U80001U43lsr0A0k8FaA1U1V44kUA028Ua41U0944kUA018Ua41U0N2Al0A0y6D7s1U0000k0A0000601U0000k0A0000001U000000A0000001U000000DzzzzzzzU"
	WinActivate, iPi Mocap Studio
	Sleep, 5000
	cvClickWait(Text)
}

trackForward()
{
	WinActivate, iPi Mocap Studio
	Send, ^+.
	waitUntilTrackingDone()
}

refineBackward()
{
	Text:="|<>*157$193.zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzk0000000000000000000000000000000M0000000000000000000000000000000A000000000000000000000000000000060000000000000000000000000000000300000000000000000000000000000001U0000000000000000000000000000000k0000000000000000000000000000000M0000000000000000000000000000000A00000000000000000000000000000006000000Dk0Ck000TU00M00000A00000030000007w0DM000Ds00A0000060000001U00000360600006A0060000030000000k000001X7bqTVs36T3nDbBwSTU000000M000000zbNnDta1aBntgnarCTk000000A000000T36laAX0y0PUyNm1aAM0000006000000AnzMn6zUTlxUS6v7n6A00000030000006RkANXM0ANakD3rbNX60000001U0000036M6Ali06BXM7lvqAlX0000000k000001Xin6Mng3yvbnQtniMzU000000M000000kntXAMy1yDltaAMzADk000000A000000000000000000000000000000060000000000000000000000000000000300000000000000000000000000000001U0000000000000000000000000000000k0000000000000000000000000000000M0000000000000000000000000000000A0000000000000000000000000000000600000000000000000000000000000003zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzU"
	WinActivate, iPi Mocap Studio
	cvClick(Text)
	waitUntilTrackingDone()
}

refineForward()
{
	Text:="|<>*160$192.zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzU0000000000000000000000000000001U0000000000000000000000000000001U0000000000000000000000000000001U0000000000000000000000000000001U0000000000000000000000000000001U0000000000000000000000000000001U0000000000000000000000000000001U0000000000000000000000000000001U0000000000000000000000000000001U00000000DU0T0001y0000000E000001U000000008k0k000100000000E000001U000000008E0k000100000000E000001U000000008FtxDkw10T7snD7bk000001U000000008nAlCNa10la8nF6Ak000001U00000000DW4lAP21wUa9m1YME000001U000000009XylAPy10UaBGDYME000001U000000008m0lAP010UaBSNYME000001U000000008G0lAP010Ua7QlYME000001U000000008P4lANW10la6AHYAk000001U000000008BwlAMw10T66ATY7k000001U0000000000000000000000000000001U0000000000000000000000000000001U0000000000000000000000000000001U0000000000000000000000000000001U0000000000000000000000000000001U0000000000000000000000000000001U0000000000000000000000000000001U0000000000000000000000000000001zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzU"
	WinActivate, iPi Mocap Studio
	cvClick(Text)
	waitUntilTrackingDone()
}

trackingDropDown()
{
	Text:="|<>*159$125.zU006100000M00030E0008000A000000k0000EU000E000M000001U0000V0000XvkSn9i7E7X7sw/HmsyQF74F1gHaNU8aMn4MW6NbAWA0Y3EaBV01AVYAV48H4M4MD871AP20SN3M928Ea8k8kWED2Mq414m6kG4EVAFUFX4UO4lg869YAVY8V2MX0X6NUm9X8kAnAtW8FW4l6F67FtbH6CUCaDlsEVY9WAU0000000100010000000000000000600060000000000000003s003s00000002"
	WinActivate, iPi Mocap Studio
	cvClick(Text,, 100)
}

addPass()
{
	Text:="|<>*179$88.0000000000001s0w00000000000Dk3D00000000000X0RzU0000000002g1zDs000000000+k3zXs000000000f00ztUzk6000006g00Ty0M0M0000Duzrzzk1U1U0001UA1zzz06D6Nwk06zzbMlg0NaPAH00PzyRnbk1UNslU01zzznrj06Db3y003yjzzzw0NaQA0000OkDzzk1YNsk0000f0zzz06Nan4k002g3zzw0NyNbn000+kDzzk000000000z0zzz0000000003w3zzw0000000007U8"
	WinActivate, iPi Mocap Studio
	if (FindText(X:="wait", Y:=-1, 0, 0, 0, 0, 0, 0, Text))
	{
		FindText().Click(X+30, Y, "L")
		FindText().Click(X+100, Y, "L")
		Send, {End}{Enter}
	}
}

standardTracking()
{
	trackingDropDown()
	Send, {down}{Enter}
	SLeep, 500
}

fastTracking()
{
	
	trackingDropDown()
	Send, {up}{Enter}
	SLeep, 500
}

setStart(tp1)
{
	goToFrame(tp1)
	Sleep, 500
	Text:="|<>*175$65.000TU00001y000z000003w001zzw03zzs003zzw07zzk007zzs0DzzU00Dzzk0Tzzzk0TzzU0zzyS00zzz01zzwM01zzy03zzs003zzw07zzk007zzs0TzzU00Dzzk0Tzz000Tk00003y000zU00007y"
	cvClick(Text)
	Sleep, 500
}

editButton()
{
	Text:="|<>*163$24.z0H0U0EAU0EAU7nTU8nAyMHAUEHAUEHAUMnAUMnAzDH7U"
	cvClick(Text)
}

loadPose(file)
{
	WinActivate, iPi Mocap Studio
	editButton()
	; Load Pose From File Button
	Text:="|<>*158$178.y00000s00001wm000003tA0400000D4000060000040800U00kY00E00000wM0000M00000E0U020020E01000003lbVsw3vnkiw10mD0yD0M1Ai5kS7Wnz6lAaM6AMXCE439W0X6104n4MWA3AMwG6kEUMV38l0TAY828840H8N3MEAV3yM9Vy1WA4X410mTk8UUE1AVYB17m4D1UXY068kGAE43900W2104m6Eo4n8Ew262E0MV38l0EAY028860H8N2MGAV3kAG9W1W68X410mMU8lUA9Al6MX8m6T0SD3k68D2AE438y0tw0T4msT1sT8Dk000000000000000000000800000000000000000000000000000U0000002"
	cvClick(Text)
	; Select File
	Text:="|<>*165$72.D0300007P000E03001UA3000k03001UA3000k3n7VvsTH7U0M4PAn1UAHAk0CAP8G1UAH8E03DvDy1UAHTk01g3861UAHM001g3821UAH800Va3AH1UAHAGPz3n7lssAH7WPU"
	cvClick(Text)
	WinWaitActive, Choose File to Load Pose
	Send, %file%{Enter}
	WinWaitActive, Load Pose from File
	Send, {Enter}
	; Paste Pose
	WinWaitActive, iPi Mocap Studio
	Send, ^v
}

setEnd(tp2)
{
	goToFrame(tp2)
	Sleep, 500
	Text:="|<>*179$75.z000003w07zz7s00000Tk0zzwzzy01zzy07zzbzzk0Tzzk0zzwzzz03zzy07zzbzzs0Tzzk0zzwzzz03zzy07zzrzzs0Tzzk0zzzzzz03zzy07zzzzzs0Tzzk07zzzzz03zzy00zzzzzk0Dzzk07zzz000007y00zzzs00000zk07zz0000000000zzw"
	cvClick(Text)
	Sleep, 500
}

setROI()
{
	Text:="|<>*186$77.00z01zzs0000001y03zzk00001zzy07zzU00k07zzw0Dzz003U0Dzzs0Tzy00DU0Tzzk0zzw03zzkzzzU1zzy06w0Fzzz03zzw08k03zzy07zzw0G0A7zzw03zzs0g4QTzzs03zzk100FDzzk07zzU200401zU0Dzz0400E03y00Tzy0DzzU00000zzw0000000001zzs00008"
	WinActivate, iPi Mocap Studio
	cvClick(Text)
}

shoulders() ;; fix
{
	Text:="|<>*155$67.T800020k000MY00010M000820000UA00041Q7W4FyD5bj0n4N29XAn46MMa4V4VY9W078G2EWEnwVk0Y918F8N0EA0G4kY8YAU814N28nAH6MY1jsV3ku8z7W7b"
	cvClick(Text,, 150)
}

spine() ;; fix 
{
	Text:="|<>*159$38.T01000AE00002000000U/lDkww36HYFYklYlg8789APy0G2H6k04VYlg0XAFANWTWsH6D40U00000800000200002"
	cvClick(Text,, 150)
}

disableAdvancedTracking()
{
	disableHeadTracking()
	disableFootTracking()
	disableGroundCollisions()
	
	; Dont Track Shoulders From Video
	shoulders()
	Send, {up}{Enter}
	
	; Not Flexible Spine
	spine()
	Send, {up 2}{Enter}
}

enableAdvancedTracking()
{
	enableHeadTracking()
	enableFootTracking()
	enableGroundCollisions()
	
	; Track Shoulders From Video
	shoulders()
	Send, {down}{Enter}
	
	; Flexible Spine
	spine()
	Send, {down 2}{Enter}
}

refitLeftArm()
{
	enableLeftArm()
	Loop, 2
		refitPose()
	disableLeftArm()
}

refitRightArm()
{
	enableRightArm()
	Loop, 2
		refitPose()
	disableRightArm()
}

refitLeftLeg()
{
	enableLeftLeg()
	Loop, 2
		refitPose()
	disableLeftLeg()
}

refitRightLeg()
{
	enableRightLeg()
	Loop, 2
		refitPose()
	disableRightLeg()
}

waitForGroundPlane()
{
	Text:="|<>*181$166.0000000000000000000U03000003w000001U0000000000600A000008M0A003600000000000M00k00000Uk0k00A000000000001U0300000213XVkRs0kQ0C0XU0/Uy0AAQ30k086TTDXzqTXw1ySTaAz7s7wntzDU0UP4lWMANWMkANX6MnAlUMn0aAn021cP4D0lYB30Va8BX8G61VgTMq4084zgzw36EwA66MUqAV8M66rBXTk0Um0l0kAN3kk8NW3Mm4VUMHMqBU026A361UlYBX0laANX8H61XBbMn04DkT7TblqEnw1yMT7wVDs7wrxXDaHy0s8Q62006k3M0s620A0T0600C10000000000301U0000001U0000000000000004M2A000000060000000000000000T0DU0000000M0000002"
	Sleep, 5000
	cvClickWait(Text)
}

;; Record Screen for Debugging
;Run, %include%\ffmpeg -y -f gdigrab -framerate 30 -i desktop -c:v h264_nvenc -qp 0 .\output.mkv,, Min, ffmpegPID
;ExitFunc()
;{
;	Run, taskkill /im ffmpeg.exe,, Hide
;}
;OnExit("ExitFunc")

Loop Files, .\*.iPiVideo
{
	SplitPath, A_LoopFileLongPath, OutFileName, OutDir, OutExtension, OutNameNoExt, OutDrive
	
	; Open File
    Run, C:\Program Files (x86)\iPiSoft\iPi Mocap Studio 4\iPiMocapStudio.exe, C:\Program Files (x86)\iPiSoft\iPi Mocap Studio 4,, iPiPID
	WinWaitActive, ahk_pid %iPiPID%
	
	; Check a Bit for Continuing Trial
	WinWaitActive, License Dialog
	Sleep, 1000
	ControlSend,, {Tab 2}{Enter}, License Dialog
	Sleep, 5000

	; File New Project	
	Sleep, 500
	ControlSend,, {Tab}{Enter 2}, iPi Mocap Studio
	
	WinWaitActive, Please`, Choose Video File
	Send, %A_LoopFileLongPath%{Enter}
	
	; Load Actor File
	WinWaitActive, New Project Wizard - %A_LoopFileName%
	Sleep, 500
	Send, {Tab 3}{Enter}
	WinWaitActive, Please`, Choose File to Load Actor Parameters
	Sleep, 500
	Send, %OutDir%\%OutNameNoExt%.iPiActor{Enter}
	
	; Finish Loading
	WinWaitActive, New Project Wizard - %A_LoopFileName%
	Sleep, 500
	Send, {Tab 5}{Enter}
	
	; Wait for Loading and Ground Plane Detection
	WinWaitActive, iPi Mocap Studio
	waitForGroundPlane()
	ExitApp
	; Jitter Trajectory
	Text:="|<>*217$140.00080000000000000000000000200000000000000000000100U00000000000000000001UDDXnrswy00000000000001k2HBalaNgk0000000000000k0kX1gMwPA00000000000006078nv6Dyn00000000000000M0OBalXkAk000000000000011aXNgNa3A000000000000000D8rv7kyn00000000000000000001U0000000000000000000000M0000000000000000000000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003zz000000000000000000000k0k0000000000000000000080400000000000000000000201000000000000000000000U0E0000000000000000000080400000000000000000000201000000000000000000000U0Tzzzzzzzzzzzzzzzzzzzzs0400000000000000000000201000000000000000000000U0E00000000000000000000807zzzzzzzzzzzzzzzzzzzzy01000000000000000000000U0E00000000000000000000A0A000000000000000000001U6000000000000000000000A100000000000000000000010k000000000000000000000MM0000000000000000000003A0000000000000000000000S00000000000000000000003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000w000000000M00000000DU00P000000000C000000002A00AM000000007U0000000030036000000000M000000000k00lU000000006000000000M00AM000000001U00000000C0036000000000M000000006000lU0000000060000000030006k000000001U00000000U000s000000000M00000000Dk08"
	cvClick(Text)
	
	; Jitter Options
	Text:="|<>*184$63.3k00A000001VU0E000000840200000030mswVsz7U0E2MW4la9Y020G6EY4lA00E2Em4UaAk030m6EY4lXU084Em4UaA401VX4MaAlcYa3kT1YT6BsYk0200000000zzzzzzzzzzs0200000000U"
	cvClick(Text)
	WinWaitActive, Jitter Removal Options
	Sleep, 500
	Send, {Tab}
	Loop, 6
	{
		Send, {Tab}{left 5}{right}
		Sleep, 250
	}
	Send, {Tab}{Enter}

	; Read in Frame Windows
	pass = 0
	Loop, Read, %OutDir%\%OutNameNoExt%.tps
	{
		If (pass) ; Add Take/Pass
			addPass()
		
		frameNums := StrSplit(A_LoopReadLine, ",")
		tp1 := frameNums[1]
		tp2 := frameNums[2]
		tpMid := tp1 + Round((tp2 - tp1)/2)
		
		; Set ROI Bounds
		setStart(tp1)
		setEnd(tp2)
		setROI()
		
		; Go to End frame(s)
		goToFrame(tpMid)
		;; Load Camera-Proximal T-Pose
		;loadPose(".\proximalTpose.iPiPose")
		
		; Turn off appendage fitting for translation
		disableAppendages()
		disableAdvancedTracking()

		; Translate Body
		standardTracking()
		refitPose()
		
		; Fit Appendages
		enableAdvancedTracking()
		fastTracking()
		refitLeftArm()
		refitRightArm()
		refitLeftLeg()
		refitRightLeg()
		
		; Final Fit
		enableAppendages()
		standardTracking()
		refitPose()
		
		;; Perform Actor Model Creation Here
		; If (!pass)
		;{
			;
		;}
		
		; Perform Tracking
		trackBackward()
		goToFrame(tpMid-15)
		trackForward()
		refineBackward()
		
		pass += 1
	}
	
	ExitApp
}

ExitApp
